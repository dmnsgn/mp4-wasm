var Fr=function(){var _=import.meta.url;return function(t){t=t||{};var t=typeof t!="undefined"?t:{},u,h;t.ready=new Promise(function(r,n){u=r,h=n}),t.create_buffer=function(n){return t._malloc(n)},t.free_buffer=function(n){return t._free(n)},t.locateFile=function(n,e){return t.simd&&(n=n.replace(/\.wasm$/i,".simd.wasm")),t.getWasmPath?t.getWasmPath(n,e,t.simd):e+n},t.createWebCodecsEncoder=function(n){return Kr(t,n)};var w={},l;for(l in t)t.hasOwnProperty(l)&&(w[l]=t[l]);var p=[],H="./this.program",L=function(r,n){throw n},R=!1,S=!1,x=!1,k=!1;R=typeof window=="object",S=typeof importScripts=="function",x=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",k=!R&&!x&&!S;var d="";function j(r){return t.locateFile?t.locateFile(r,d):d+r}var er,sr,tr,J;(R||S)&&(S?d=self.location.href:typeof document!="undefined"&&document.currentScript&&(d=document.currentScript.src),_&&(d=_),d.indexOf("blob:")!==0?d=d.substr(0,d.lastIndexOf("/")+1):d="",er=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.send(null),e.responseText},S&&(tr=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),sr=function(n,e,i){var a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){e(a.response);return}i()},a.onerror=i,a.send(null)},J=function(r){document.title=r});var q=t.print||console.log.bind(console),z=t.printErr||console.warn.bind(console);for(l in w)w.hasOwnProperty(l)&&(t[l]=w[l]);w=null,t.arguments&&(p=t.arguments),t.thisProgram&&(H=t.thisProgram),t.quit&&(L=t.quit);var X;t.wasmBinary&&(X=t.wasmBinary);var cr;t.noExitRuntime&&(cr=t.noExitRuntime),typeof WebAssembly!="object"&&Q("no native wasm support detected");var y,A=!1,W=0;function b(r,n){r||Q("Assertion failed: "+n)}function U(r,n,e){for(var i=n+e,a="";!(n>=i);){var f=r[n++];if(!f)return a;if(!(f&128)){a+=String.fromCharCode(f);continue}var c=r[n++]&63;if((f&224)==192){a+=String.fromCharCode((f&31)<<6|c);continue}var o=r[n++]&63;if((f&240)==224?f=(f&15)<<12|c<<6|o:f=(f&7)<<18|c<<12|o<<6|r[n++]&63,f<65536)a+=String.fromCharCode(f);else{var s=f-65536;a+=String.fromCharCode(55296|s>>10,56320|s&1023)}}return a}function ur(r,n){return r?U(F,r,n):""}function Zr(r,n,e,i){if(!(i>0))return 0;for(var a=e,f=e+i-1,c=0;c<r.length;++c){var o=r.charCodeAt(c);if(o>=55296&&o<=57343){var s=r.charCodeAt(++c);o=65536+((o&1023)<<10)|s&1023}if(o<=127){if(e>=f)break;n[e++]=o}else if(o<=2047){if(e+1>=f)break;n[e++]=192|o>>6,n[e++]=128|o&63}else if(o<=65535){if(e+2>=f)break;n[e++]=224|o>>12,n[e++]=128|o>>6&63,n[e++]=128|o&63}else{if(e+3>=f)break;n[e++]=240|o>>18,n[e++]=128|o>>12&63,n[e++]=128|o>>6&63,n[e++]=128|o&63}}return n[e]=0,e-a}function Qr(r,n,e){return Zr(r,F,n,e)}function Mr(r){for(var n=0,e=0;e<r.length;++e){var i=r.charCodeAt(e);i>=55296&&i<=57343&&(i=65536+((i&1023)<<10)|r.charCodeAt(++e)&1023),i<=127?++n:i<=2047?n+=2:i<=65535?n+=3:n+=4}return n}function rn(r,n){for(var e="",i=0;!(i>=n/2);++i){var a=Z[r+i*2>>1];if(a==0)break;e+=String.fromCharCode(a)}return e}function nn(r,n,e){if(e===void 0&&(e=2147483647),e<2)return 0;e-=2;for(var i=n,a=e<r.length*2?e/2:r.length,f=0;f<a;++f){var c=r.charCodeAt(f);Z[n>>1]=c,n+=2}return Z[n>>1]=0,n-i}function en(r){return r.length*2}function tn(r,n){for(var e=0,i="";!(e>=n/4);){var a=O[r+e*4>>2];if(a==0)break;if(++e,a>=65536){var f=a-65536;i+=String.fromCharCode(55296|f>>10,56320|f&1023)}else i+=String.fromCharCode(a)}return i}function an(r,n,e){if(e===void 0&&(e=2147483647),e<4)return 0;for(var i=n,a=i+e-4,f=0;f<r.length;++f){var c=r.charCodeAt(f);if(c>=55296&&c<=57343){var o=r.charCodeAt(++f);c=65536+((c&1023)<<10)|o&1023}if(O[n>>2]=c,n+=4,n+4>a)break}return O[n>>2]=0,n-i}function on(r){for(var n=0,e=0;e<r.length;++e){var i=r.charCodeAt(e);i>=55296&&i<=57343&&++e,n+=4}return n}function fn(r,n){return r%n>0&&(r+=n-r%n),r}var K,_r,F,Z,hr,O,I,Sr,Wr;function kr(r){K=r,t.HEAP8=_r=new Int8Array(r),t.HEAP16=Z=new Int16Array(r),t.HEAP32=O=new Int32Array(r),t.HEAPU8=F=new Uint8Array(r),t.HEAPU16=hr=new Uint16Array(r),t.HEAPU32=I=new Uint32Array(r),t.HEAPF32=Sr=new Float32Array(r),t.HEAPF64=Wr=new Float64Array(r)}var Or=t.INITIAL_MEMORY||16777216;t.wasmMemory?y=t.wasmMemory:y=new WebAssembly.Memory({initial:Or/65536,maximum:2147483648/65536}),y&&(K=y.buffer),Or=K.byteLength,kr(K);var ir,Ir=[],Dr=[],sn=[],Vr=[],cn=!1;function un(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)_n(t.preRun.shift());lr(Ir)}function ln(){cn=!0,lr(Dr)}function vn(){lr(sn)}function pn(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)hn(t.postRun.shift());lr(Vr)}function _n(r){Ir.unshift(r)}function hn(r){Vr.unshift(r)}var G=0,gr=null,ar=null;function gn(r){G++,t.monitorRunDependencies&&t.monitorRunDependencies(G)}function yn(r){if(G--,t.monitorRunDependencies&&t.monitorRunDependencies(G),G==0&&(gr!==null&&(clearInterval(gr),gr=null),ar)){var n=ar;ar=null,n()}}t.preloadedImages={},t.preloadedAudios={};function Q(r){t.onAbort&&t.onAbort(r),r+="",z(r),A=!0,W=1,r="abort("+r+"). Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(r);throw h(n),n}function dn(r,n){return String.prototype.startsWith?r.startsWith(n):r.indexOf(n)===0}var mn="data:application/octet-stream;base64,";function Hr(r){return dn(r,mn)}var B="mp4.wasm";Hr(B)||(B=j(B));function Lr(){try{if(X)return new Uint8Array(X);if(tr)return tr(B);throw"both async and sync fetching of the wasm failed"}catch(r){Q(r)}}function wn(){return!X&&(R||S)&&typeof fetch=="function"?fetch(B,{credentials:"same-origin"}).then(function(r){if(!r.ok)throw"failed to load wasm binary file at '"+B+"'";return r.arrayBuffer()}).catch(function(){return Lr()}):Promise.resolve().then(Lr)}function bn(){var r={a:_e};function n(c,o){var s=c.exports;t.asm=s,ir=t.asm.x,yn("wasm-instantiate")}gn("wasm-instantiate");function e(c){n(c.instance)}function i(c){return wn().then(function(o){return WebAssembly.instantiate(o,r)}).then(c,function(o){z("failed to asynchronously prepare wasm: "+o),Q(o)})}function a(){return!X&&typeof WebAssembly.instantiateStreaming=="function"&&!Hr(B)&&typeof fetch=="function"?fetch(B,{credentials:"same-origin"}).then(function(c){var o=WebAssembly.instantiateStreaming(c,r);return o.then(e,function(s){return z("wasm streaming compile failed: "+s),z("falling back to ArrayBuffer instantiation"),i(e)})}):i(e)}if(t.instantiateWasm)try{var f=t.instantiateWasm(r,n);return f}catch(c){return z("Module.instantiateWasm callback failed with error: "+c),!1}return a().catch(h),{}}function lr(r){for(;r.length>0;){var n=r.shift();if(typeof n=="function"){n(t);continue}var e=n.func;typeof e=="number"?n.arg===void 0?ir.get(e)():ir.get(e)(n.arg):e(n.arg===void 0?null:n.arg)}}function An(r,n,e){return e&&e.length?t["dynCall_"+r].apply(null,[n].concat(e)):t["dynCall_"+r].call(null,n)}function En(r,n,e){return r.indexOf("j")!=-1?An(r,n,e):ir.get(n).apply(null,e)}function Tn(r,n,e,i){Q("Assertion failed: "+ur(r)+", at: "+[n?ur(n):"unknown filename",e,i?ur(i):"unknown function"])}function yr(r){switch(r){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+r)}}function Cn(){for(var r=new Array(256),n=0;n<256;++n)r[n]=String.fromCharCode(n);jr=r}var jr=void 0;function P(r){for(var n="",e=r;F[e];)n+=jr[F[e++]];return n}var M={},Y={},vr={},Fn=48,Pn=57;function Br(r){if(r===void 0)return"_unknown";r=r.replace(/[^a-zA-Z0-9_]/g,"$");var n=r.charCodeAt(0);return n>=Fn&&n<=Pn?"_"+r:r}function Nr(r,n){return r=Br(r),new Function("body","return function "+r+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(n)}function dr(r,n){var e=Nr(n,function(i){this.name=n,this.message=i;var a=new Error(i).stack;a!==void 0&&(this.stack=this.toString()+`
`+a.replace(/^Error(:[^\n]*)?\n/,""))});return e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},e}var xr=void 0;function E(r){throw new xr(r)}var qr=void 0;function zr(r){throw new qr(r)}function Un(r,n,e){r.forEach(function(o){vr[o]=n});function i(o){var s=e(o);s.length!==r.length&&zr("Mismatched type converter count");for(var v=0;v<r.length;++v)D(r[v],s[v])}var a=new Array(n.length),f=[],c=0;n.forEach(function(o,s){Y.hasOwnProperty(o)?a[s]=Y[o]:(f.push(o),M.hasOwnProperty(o)||(M[o]=[]),M[o].push(function(){a[s]=Y[o],++c,c===f.length&&i(a)}))}),f.length===0&&i(a)}function D(r,n,e){if(e=e||{},!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=n.name;if(r||E('type "'+i+'" must have a positive integer typeid pointer'),Y.hasOwnProperty(r)){if(e.ignoreDuplicateRegistrations)return;E("Cannot register type '"+i+"' twice")}if(Y[r]=n,delete vr[r],M.hasOwnProperty(r)){var a=M[r];delete M[r],a.forEach(function(f){f()})}}function Rn(r,n,e,i,a){var f=yr(e);n=P(n),D(r,{name:n,fromWireType:function(c){return!!c},toWireType:function(c,o){return o?i:a},argPackAdvance:8,readValueFromPointer:function(c){var o;if(e===1)o=_r;else if(e===2)o=Z;else if(e===4)o=O;else throw new TypeError("Unknown boolean type size: "+n);return this.fromWireType(o[c>>f])},destructorFunction:null})}var mr=[],T=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function wr(r){r>4&&--T[r].refcount==0&&(T[r]=void 0,mr.push(r))}function Sn(){for(var r=0,n=5;n<T.length;++n)T[n]!==void 0&&++r;return r}function Wn(){for(var r=5;r<T.length;++r)if(T[r]!==void 0)return T[r];return null}function kn(){t.count_emval_handles=Sn,t.get_first_emval=Wn}function rr(r){switch(r){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var n=mr.length?mr.pop():T.length;return T[n]={refcount:1,value:r},n}}}function br(r){return this.fromWireType(I[r>>2])}function On(r,n){n=P(n),D(r,{name:n,fromWireType:function(e){var i=T[e].value;return wr(e),i},toWireType:function(e,i){return rr(i)},argPackAdvance:8,readValueFromPointer:br,destructorFunction:null})}function Ar(r){if(r===null)return"null";var n=typeof r;return n==="object"||n==="array"||n==="function"?r.toString():""+r}function In(r,n){switch(n){case 2:return function(e){return this.fromWireType(Sr[e>>2])};case 3:return function(e){return this.fromWireType(Wr[e>>3])};default:throw new TypeError("Unknown float type: "+r)}}function Dn(r,n,e){var i=yr(e);n=P(n),D(r,{name:n,fromWireType:function(a){return a},toWireType:function(a,f){if(typeof f!="number"&&typeof f!="boolean")throw new TypeError('Cannot convert "'+Ar(f)+'" to '+this.name);return f},argPackAdvance:8,readValueFromPointer:In(n,i),destructorFunction:null})}function Vn(r,n){if(!(r instanceof Function))throw new TypeError("new_ called with constructor type "+typeof r+" which is not a function");var e=Nr(r.name||"unknownFunctionName",function(){});e.prototype=r.prototype;var i=new e,a=r.apply(i,n);return a instanceof Object?a:i}function Xr(r){for(;r.length;){var n=r.pop(),e=r.pop();e(n)}}function Hn(r,n,e,i,a){var f=n.length;f<2&&E("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var c=n[1]!==null&&e!==null,o=!1,s=1;s<n.length;++s)if(n[s]!==null&&n[s].destructorFunction===void 0){o=!0;break}for(var v=n[0].name!=="void",g="",m="",s=0;s<f-2;++s)g+=(s!==0?", ":"")+"arg"+s,m+=(s!==0?", ":"")+"arg"+s+"Wired";var C="return function "+Br(r)+"("+g+`) {
if (arguments.length !== `+(f-2)+`) {
throwBindingError('function `+r+" called with ' + arguments.length + ' arguments, expected "+(f-2)+` args!');
}
`;o&&(C+=`var destructors = [];
`);var $=o?"destructors":"null",N=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],fr=[E,i,a,Xr,n[0],n[1]];c&&(C+="var thisWired = classParam.toWireType("+$+`, this);
`);for(var s=0;s<f-2;++s)C+="var arg"+s+"Wired = argType"+s+".toWireType("+$+", arg"+s+"); // "+n[s+2].name+`
`,N.push("argType"+s),fr.push(n[s+2]);if(c&&(m="thisWired"+(m.length>0?", ":"")+m),C+=(v?"var rv = ":"")+"invoker(fn"+(m.length>0?", ":"")+m+`);
`,o)C+=`runDestructors(destructors);
`;else for(var s=c?1:2;s<n.length;++s){var nr=s===1?"thisWired":"arg"+(s-2)+"Wired";n[s].destructorFunction!==null&&(C+=nr+"_dtor("+nr+"); // "+n[s].name+`
`,N.push(nr+"_dtor"),fr.push(n[s].destructorFunction))}v&&(C+=`var ret = retType.fromWireType(rv);
return ret;
`),C+=`}
`,N.push(C);var ye=Vn(Function,N).apply(null,fr);return ye}function Ln(r,n,e){if(r[n].overloadTable===void 0){var i=r[n];r[n]=function(){return r[n].overloadTable.hasOwnProperty(arguments.length)||E("Function '"+e+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+r[n].overloadTable+")!"),r[n].overloadTable[arguments.length].apply(this,arguments)},r[n].overloadTable=[],r[n].overloadTable[i.argCount]=i}}function jn(r,n,e){t.hasOwnProperty(r)?((e===void 0||t[r].overloadTable!==void 0&&t[r].overloadTable[e]!==void 0)&&E("Cannot register public name '"+r+"' twice"),Ln(t,r,r),t.hasOwnProperty(e)&&E("Cannot register multiple overloads of a function with the same number of arguments ("+e+")!"),t[r].overloadTable[e]=n):(t[r]=n,e!==void 0&&(t[r].numArguments=e))}function Bn(r,n){for(var e=[],i=0;i<r;i++)e.push(O[(n>>2)+i]);return e}function Nn(r,n,e){t.hasOwnProperty(r)||zr("Replacing nonexistant public symbol"),t[r].overloadTable!==void 0&&e!==void 0?t[r].overloadTable[e]=n:(t[r]=n,t[r].argCount=e)}function xn(r,n){b(r.indexOf("j")>=0,"getDynCaller should only be called with i64 sigs");var e=[];return function(){e.length=arguments.length;for(var i=0;i<arguments.length;i++)e[i]=arguments[i];return En(r,n,e)}}function qn(r,n){r=P(r);function e(){return r.indexOf("j")!=-1?xn(r,n):ir.get(n)}var i=e();return typeof i!="function"&&E("unknown function pointer with signature "+r+": "+n),i}var Gr=void 0;function Yr(r){var n=Jr(r),e=P(n);return V(n),e}function zn(r,n){var e=[],i={};function a(f){if(!i[f]&&!Y[f]){if(vr[f]){vr[f].forEach(a);return}e.push(f),i[f]=!0}}throw n.forEach(a),new Gr(r+": "+e.map(Yr).join([", "]))}function Xn(r,n,e,i,a,f){var c=Bn(n,e);r=P(r),a=qn(i,a),jn(r,function(){zn("Cannot call "+r+" due to unbound types",c)},n-1),Un([],c,function(o){var s=[o[0],null].concat(o.slice(1));return Nn(r,Hn(r,s,null,a,f),n-1),[]})}function Gn(r,n,e){switch(n){case 0:return e?function(a){return _r[a]}:function(a){return F[a]};case 1:return e?function(a){return Z[a>>1]}:function(a){return hr[a>>1]};case 2:return e?function(a){return O[a>>2]}:function(a){return I[a>>2]};default:throw new TypeError("Unknown integer type: "+r)}}function Yn(r,n,e,i,a){n=P(n),a===-1&&(a=4294967295);var f=yr(e),c=function(v){return v};if(i===0){var o=32-8*e;c=function(v){return v<<o>>>o}}var s=n.indexOf("unsigned")!=-1;D(r,{name:n,fromWireType:c,toWireType:function(v,g){if(typeof g!="number"&&typeof g!="boolean")throw new TypeError('Cannot convert "'+Ar(g)+'" to '+this.name);if(g<i||g>a)throw new TypeError('Passing a number "'+Ar(g)+'" from JS side to C/C++ side to an argument of type "'+n+'", which is outside the valid range ['+i+", "+a+"]!");return s?g>>>0:g|0},argPackAdvance:8,readValueFromPointer:Gn(n,f,i!==0),destructorFunction:null})}function $n(r,n,e){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],a=i[n];function f(c){c=c>>2;var o=I,s=o[c],v=o[c+1];return new a(K,v,s)}e=P(e),D(r,{name:e,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{ignoreDuplicateRegistrations:!0})}function Jn(r,n){n=P(n);var e=n==="std::string";D(r,{name:n,fromWireType:function(i){var a=I[i>>2],f;if(e)for(var c=i+4,o=0;o<=a;++o){var s=i+4+o;if(o==a||F[s]==0){var v=s-c,g=ur(c,v);f===void 0?f=g:(f+=String.fromCharCode(0),f+=g),c=s+1}}else{for(var m=new Array(a),o=0;o<a;++o)m[o]=String.fromCharCode(F[i+4+o]);f=m.join("")}return V(i),f},toWireType:function(i,a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));var f,c=typeof a=="string";c||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int8Array||E("Cannot pass non-string to std::string"),e&&c?f=function(){return Mr(a)}:f=function(){return a.length};var o=f(),s=Tr(4+o+1);if(I[s>>2]=o,e&&c)Qr(a,s+4,o+1);else if(c)for(var v=0;v<o;++v){var g=a.charCodeAt(v);g>255&&(V(s),E("String has UTF-16 code units that do not fit in 8 bits")),F[s+4+v]=g}else for(var v=0;v<o;++v)F[s+4+v]=a[v];return i!==null&&i.push(V,s),s},argPackAdvance:8,readValueFromPointer:br,destructorFunction:function(i){V(i)}})}function Kn(r,n,e){e=P(e);var i,a,f,c,o;n===2?(i=rn,a=nn,c=en,f=function(){return hr},o=1):n===4&&(i=tn,a=an,c=on,f=function(){return I},o=2),D(r,{name:e,fromWireType:function(s){for(var v=I[s>>2],g=f(),m,C=s+4,$=0;$<=v;++$){var N=s+4+$*n;if($==v||g[N>>o]==0){var fr=N-C,nr=i(C,fr);m===void 0?m=nr:(m+=String.fromCharCode(0),m+=nr),C=N+n}}return V(s),m},toWireType:function(s,v){typeof v!="string"&&E("Cannot pass non-string to C++ string type "+e);var g=c(v),m=Tr(4+g+n);return I[m>>2]=g>>o,a(v,m+4,g+n),s!==null&&s.push(V,m),m},argPackAdvance:8,readValueFromPointer:br,destructorFunction:function(s){V(s)}})}function Zn(r,n){n=P(n),D(r,{isVoid:!0,name:n,argPackAdvance:0,fromWireType:function(){},toWireType:function(e,i){}})}function or(r){return r||E("Cannot use deleted val. handle = "+r),T[r].value}function Er(r,n){var e=Y[r];return e===void 0&&E(n+" has unknown type "+Yr(r)),e}function Qn(r,n,e){r=or(r),n=Er(n,"emval::as");var i=[],a=rr(i);return O[e>>2]=a,n.toWireType(i,r)}function Mn(r,n){for(var e=new Array(r),i=0;i<r;++i)e[i]=Er(O[(n>>2)+i],"parameter "+i);return e}function re(r,n,e,i){r=or(r);for(var a=Mn(n,e),f=new Array(n),c=0;c<n;++c){var o=a[c];f[c]=o.readValueFromPointer(i),i+=o.argPackAdvance}var s=r.apply(void 0,f);return rr(s)}function ne(r,n){return r=or(r),n=or(n),rr(r[n])}function ee(r){r>4&&(T[r].refcount+=1)}function te(r){return r=or(r),typeof r=="number"}var ie={};function ae(r){var n=ie[r];return n===void 0?P(r):n}function oe(r){return rr(ae(r))}function fe(r){var n=T[r].value;Xr(n),wr(r)}function se(r,n){r=Er(r,"_emval_take_value");var e=r.readValueFromPointer(n);return rr(e)}function ce(){Q()}function ue(r,n,e){F.copyWithin(r,n,n+e)}function le(){return F.length}function ve(r){try{return y.grow(r-K.byteLength+65535>>>16),kr(y.buffer),1}catch(n){}}function pe(r){r=r>>>0;var n=le(),e=2147483648;if(r>e)return!1;for(var i=16777216,a=1;a<=4;a*=2){var f=n*(1+.2/a);f=Math.min(f,r+100663296);var c=Math.min(e,fn(Math.max(i,r,f),65536)),o=ve(c);if(o)return!0}return!1}Cn(),xr=t.BindingError=dr(Error,"BindingError"),qr=t.InternalError=dr(Error,"InternalError"),kn(),Gr=t.UnboundTypeError=dr(Error,"UnboundTypeError"),Dr.push({func:function(){$r()}});var _e={b:Tn,u:Rn,t:On,n:Dn,l:Xn,e:Yn,d:$n,o:Jn,m:Kn,v:Zn,k:Qn,w:re,c:wr,f:ne,h:ee,q:te,g:oe,j:fe,i:se,p:ce,r:ue,s:pe,a:y},Ee=bn(),$r=t.___wasm_call_ctors=function(){return($r=t.___wasm_call_ctors=t.asm.y).apply(null,arguments)},Tr=t._malloc=function(){return(Tr=t._malloc=t.asm.z).apply(null,arguments)},V=t._free=function(){return(V=t._free=t.asm.A).apply(null,arguments)},Jr=t.___getTypeName=function(){return(Jr=t.___getTypeName=t.asm.B).apply(null,arguments)},he=t.___embind_register_native_and_builtin_types=function(){return(he=t.___embind_register_native_and_builtin_types=t.asm.C).apply(null,arguments)},ge=t.dynCall_ijiii=function(){return(ge=t.dynCall_ijiii=t.asm.D).apply(null,arguments)},pr;ar=function r(){pr||Cr(),pr||(ar=r)};function Cr(r){if(r=r||p,G>0||(un(),G>0))return;function n(){pr||(pr=!0,t.calledRun=!0,!A&&(ln(),vn(),u(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),pn()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),n()},1)):n()}if(t.run=Cr,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return cr=!0,Cr(),t.ready}}(),de=Fr,Pr=new Uint8Array([0,0,0,1]);function me(_){console.error(_)}Fr.createFile=Ur;function Ur(_=256){let t=0,u=0,h=new Uint8Array(_);return{contents:function(){return h.slice(0,u)},seek:function(l){t=l},write:function(l){let p=l.byteLength;return w(t+p),h.set(l,t),t+=p,u=Math.max(u,t),p}};function w(l){var p=h.length;if(p>=l)return;var H=1024*1024;l=Math.max(l,p*(p<H?2:1.125)>>>0),p!=0&&(l=Math.max(l,256));let L=h;h=new Uint8Array(l),u>0&&h.set(L.subarray(0,u),0)}}Fr.isWebCodecsSupported=Rr;function Rr(){return typeof window!="undefined"&&typeof window.VideoEncoder=="function"}function Kr(_,t={}){let{width:u,height:h,groupOfPictures:w=20,fps:l=30,fragmentation:p=!1,sequential:H=!1,hevc:L=!1,format:R="annexb",codec:S="avc1.4d0034",acceleration:x,bitrate:k,error:d=me,flushFrequency:j=10}=t;if(!Rr())throw new Error("MP4 H264 encoding/decoding depends on WebCodecs API which is not supported in this environment");if(typeof u!="number"||typeof h!="number")throw new Error("Must specify { width, height } options");if(!isFinite(u)||u<0||!isFinite(h)||h<0)throw new Error("{ width, height } options must be positive integers");let er=Ur(),sr=_.create_muxer({width:u,height:h,fps:l,fragmentation:p,sequential:H,hevc:L},z),tr={codec:S,width:u,height:h,avc:{format:R},acceleration:x,bitrate:k},J=0,q=new window.VideoEncoder({output(y,A){cr(y,A)},error:d});return q.configure(tr),{async end(){return await q.flush(),q.close(),_.finalize_muxer(sr),er.contents()},async addFrame(y){let A=1/l*J*1e6,W=J%w==0,b=new VideoFrame(y,{timestamp:A});q.encode(b,{keyFrame:W}),b.close(),j!=null&&(J+1)%j==0&&await q.flush(),J++},async flush(){return q.flush()}};function z(y,A,W){er.seek(W);let b=_.HEAPU8.subarray(y,y+A);return er.write(b)!==b.byteLength}function X(y){let A=_._malloc(y.byteLength);_.HEAPU8.set(y,A),_.mux_nal(sr,A,y.byteLength),_._free(A)}function cr(y,A){let W=null;if(A.description)try{W=Ae(A.description)}catch(U){d(U);return}let b=[];if(W&&(W.sps_list.forEach(U=>{b.push(Pr),b.push(U)}),W.pps_list.forEach(U=>{b.push(Pr),b.push(U)})),R==="annexb")b.push(new Uint8Array(y.data));else try{be(y.data).forEach(U=>{b.push(Pr),b.push(U)})}catch(U){d(U);return}X(we(b))}}function we(_){let t=_.reduce((w,l)=>w+l.byteLength,0),u=new Uint8Array(t),h=0;for(let w=0;w<_.length;w++){let l=_[w];u.set(l,h),h+=l.byteLength}return u}function be(_){let t=4,u=0,h=[],w=_.byteLength,l=new Uint8Array(_);for(;u+t<w;){let p=l[u];if(p=(p<<8)+l[u+1],p=(p<<8)+l[u+2],p=(p<<8)+l[u+3],h.push(new Uint8Array(_,u+t,p)),p==0)throw new Error("Error: invalid nal_length 0");u+=t+p}return h}function Ae(_){let t=new DataView(_),u=0,h=t.getUint8(u++),w=t.getUint8(u++),l=t.getUint8(u++),p=t.getUint8(u++),H=(t.getUint8(u++)&3)+1;if(H!==4)throw new Error("Expected length_size to indicate 4 bytes");let L=t.getUint8(u++)&31,R=[];for(let k=0;k<L;k++){let d=t.getUint16(u,!1);u+=2;let j=new Uint8Array(t.buffer,u,d);R.push(j),u+=d}let S=t.getUint8(u++),x=[];for(let k=0;k<S;k++){let d=t.getUint16(u,!1);u+=2;let j=new Uint8Array(t.buffer,u,d);x.push(j),u+=d}return{offset:u,version:h,profile:w,compat:l,level:p,length_size:H,pps_list:x,sps_list:R,numSPS:L}}export{Ur as createFile,Kr as createWebCodecsEncoderWithModule,de as default,Rr as isWebCodecsSupported};
//# sourceMappingURL=mp4.js.map
