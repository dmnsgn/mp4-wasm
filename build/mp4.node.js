var Fe=Object.defineProperty;var yr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var br=Object.prototype.hasOwnProperty;var Ar=(d,l)=>{for(var t in l)Fe(d,t,{get:l[t],enumerable:!0})},Er=(d,l,t,g)=>{if(l&&typeof l=="object"||typeof l=="function")for(let _ of wr(l))!br.call(d,_)&&_!==t&&Fe(d,_,{get:()=>l[_],enumerable:!(g=yr(l,_))||g.enumerable});return d};var Tr=d=>Er(Fe({},"__esModule",{value:!0}),d);var Pr={};Ar(Pr,{createFile:()=>Ue,createWebCodecsEncoderWithModule:()=>Qe,isWebCodecsSupported:()=>Re});module.exports=Tr(Pr);var oe=(()=>{var d=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(d=d||__filename),function(l){var t=l||{},t=typeof t<"u"?t:{},g,_;t.ready=new Promise(function(e,n){g=e,_=n}),t.create_buffer=function(n){return t._malloc(n)},t.free_buffer=function(n){return t._free(n)},t.locateFile=function(n,r){return t.simd&&(n=n.replace(/\.wasm$/i,".simd.wasm")),t.getWasmPath?t.getWasmPath(n,r,t.simd):r+n},t.createWebCodecsEncoder=function(n){return Qe(t,n)};var v=Object.assign({},t),h=[],O="./this.program",H=(e,n)=>{throw n},N=!1,Q=!1,z=!0,E="";function P(e){return t.locateFile?t.locateFile(e,E):E+e}var M,ae,q;function ue(e){if(e instanceof Me)return;x("exiting due to exception: "+e)}if(z){var fe=require("fs"),j=require("path");Q?E=j.dirname(E)+"/":E=__dirname+"/",M=(e,n)=>(e=Le(e)?new URL(e):j.normalize(e),fe.readFileSync(e,n?void 0:"utf8")),q=e=>{var n=M(e,!0);return n.buffer||(n=new Uint8Array(n)),n},ae=(e,n,r)=>{e=Le(e)?new URL(e):j.normalize(e),fe.readFile(e,function(i,o){i?r(i):n(o.buffer)})},process.argv.length>1&&(O=process.argv[1].replace(/\\/g,"/")),h=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof Me))throw e}),process.on("unhandledRejection",function(e){throw e}),H=(e,n)=>{if(rn())throw process.exitCode=e,n;ue(n),process.exit(e)},t.inspect=function(){return"[Emscripten Module object]"}}var Y=t.print||console.log.bind(console),x=t.printErr||console.warn.bind(console);Object.assign(t,v),v=null,t.arguments&&(h=t.arguments),t.thisProgram&&(O=t.thisProgram),t.quit&&(H=t.quit);var de=4,X;t.wasmBinary&&(X=t.wasmBinary);var b=t.noExitRuntime||!0;typeof WebAssembly!="object"&&te("no native wasm support detected");var y,k=!1,C;function V(e,n,r){for(var i=n+r,o="";!(n>=i);){var a=e[n++];if(!a)return o;if(!(a&128)){o+=String.fromCharCode(a);continue}var s=e[n++]&63;if((a&224)==192){o+=String.fromCharCode((a&31)<<6|s);continue}var u=e[n++]&63;if((a&240)==224?a=(a&15)<<12|s<<6|u:a=(a&7)<<18|s<<12|u<<6|e[n++]&63,a<65536)o+=String.fromCharCode(a);else{var f=a-65536;o+=String.fromCharCode(55296|f>>10,56320|f&1023)}}return o}function w(e,n){return e?V(U,e,n):""}function ve(e,n,r,i){if(!(i>0))return 0;for(var o=r,a=r+i-1,s=0;s<e.length;++s){var u=e.charCodeAt(s);if(u>=55296&&u<=57343){var f=e.charCodeAt(++s);u=65536+((u&1023)<<10)|f&1023}if(u<=127){if(r>=a)break;n[r++]=u}else if(u<=2047){if(r+1>=a)break;n[r++]=192|u>>6,n[r++]=128|u&63}else if(u<=65535){if(r+2>=a)break;n[r++]=224|u>>12,n[r++]=128|u>>6&63,n[r++]=128|u&63}else{if(r+3>=a)break;n[r++]=240|u>>18,n[r++]=128|u>>12&63,n[r++]=128|u>>6&63,n[r++]=128|u&63}}return n[r]=0,r-o}function Ge(e,n,r){return ve(e,U,n,r)}function en(e){for(var n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i<=127?n++:i<=2047?n+=2:i>=55296&&i<=57343?(n+=4,++r):n+=3}return n}var pe,U,G,ge,Z,S,Pe,ke;function Se(){var e=y.buffer;t.HEAP8=pe=new Int8Array(e),t.HEAP16=G=new Int16Array(e),t.HEAP32=Z=new Int32Array(e),t.HEAPU8=U=new Uint8Array(e),t.HEAPU16=ge=new Uint16Array(e),t.HEAPU32=S=new Uint32Array(e),t.HEAPF32=Pe=new Float32Array(e),t.HEAPF64=ke=new Float64Array(e)}var kr=t.INITIAL_MEMORY||16777216,We,Ie=[],Ve=[],Oe=[],nn=!1;function rn(){return b}function tn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)un(t.preRun.shift());_e(Ie)}function on(){nn=!0,_e(Ve)}function an(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)sn(t.postRun.shift());_e(Oe)}function un(e){Ie.unshift(e)}function fn(e){Ve.unshift(e)}function sn(e){Oe.unshift(e)}var $=0,he=null,re=null;function cn(e){$++,t.monitorRunDependencies&&t.monitorRunDependencies($)}function ln(e){if($--,t.monitorRunDependencies&&t.monitorRunDependencies($),$==0&&(he!==null&&(clearInterval(he),he=null),re)){var n=re;re=null,n()}}function te(e){t.onAbort&&t.onAbort(e),e="Aborted("+e+")",x(e),k=!0,C=1,e+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(e);throw _(n),n}var dn="data:application/octet-stream;base64,";function He(e){return e.startsWith(dn)}function Le(e){return e.startsWith("file://")}var W;W="mp4.node.wasm",He(W)||(W=P(W));function De(e){try{if(e==W&&X)return new Uint8Array(X);if(q)return q(e);throw"both async and sync fetching of the wasm failed"}catch(n){te(n)}}function vn(){return!X&&(N||Q)&&typeof fetch=="function"?fetch(W,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+W+"'";return e.arrayBuffer()}).catch(function(){return De(W)}):Promise.resolve().then(function(){return De(W)})}function pn(){var e={a:pr};function n(s,u){var f=s.exports;t.asm=f,y=t.asm.x,Se(),We=t.asm.B,fn(t.asm.y),ln("wasm-instantiate")}cn("wasm-instantiate");function r(s){n(s.instance)}function i(s){return vn().then(function(u){return WebAssembly.instantiate(u,e)}).then(function(u){return u}).then(s,function(u){x("failed to asynchronously prepare wasm: "+u),te(u)})}function o(){return!X&&typeof WebAssembly.instantiateStreaming=="function"&&!He(W)&&!z&&typeof fetch=="function"?fetch(W,{credentials:"same-origin"}).then(function(s){var u=WebAssembly.instantiateStreaming(s,e);return u.then(r,function(f){return x("wasm streaming compile failed: "+f),x("falling back to ArrayBuffer instantiation"),i(r)})}):i(r)}if(t.instantiateWasm)try{var a=t.instantiateWasm(e,n);return a}catch(s){x("Module.instantiateWasm callback failed with error: "+s),_(s)}return o().catch(_),{}}function Me(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function _e(e){for(;e.length>0;)e.shift()(t)}function gn(e,n,r,i){te("Assertion failed: "+w(e)+", at: "+[n?w(n):"unknown filename",r,i?w(i):"unknown function"])}function hn(e,n,r,i,o){}function me(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function _n(){for(var e=new Array(256),n=0;n<256;++n)e[n]=String.fromCharCode(n);je=e}var je=void 0;function R(e){for(var n="",r=e;U[r];)n+=je[U[r++]];return n}var ee={},K={},se={},mn=48,yn=57;function xe(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var n=e.charCodeAt(0);return n>=mn&&n<=yn?"_"+e:e}function Be(e,n){return e=xe(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(n)}function ye(e,n){var r=Be(n,function(i){this.name=n,this.message=i;var o=new Error(i).stack;o!==void 0&&(this.stack=this.toString()+`
`+o.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var Ne=void 0;function T(e){throw new Ne(e)}var ze=void 0;function qe(e){throw new ze(e)}function wn(e,n,r){e.forEach(function(u){se[u]=n});function i(u){var f=r(u);f.length!==e.length&&qe("Mismatched type converter count");for(var c=0;c<e.length;++c)L(e[c],f[c])}var o=new Array(n.length),a=[],s=0;n.forEach((u,f)=>{K.hasOwnProperty(u)?o[f]=K[u]:(a.push(u),ee.hasOwnProperty(u)||(ee[u]=[]),ee[u].push(()=>{o[f]=K[u],++s,s===a.length&&i(o)}))}),a.length===0&&i(o)}function L(e,n,r={}){if(!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=n.name;if(e||T('type "'+i+'" must have a positive integer typeid pointer'),K.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;T("Cannot register type '"+i+"' twice")}if(K[e]=n,delete se[e],ee.hasOwnProperty(e)){var o=ee[e];delete ee[e],o.forEach(a=>a())}}function bn(e,n,r,i,o){var a=me(r);n=R(n),L(e,{name:n,fromWireType:function(s){return!!s},toWireType:function(s,u){return u?i:o},argPackAdvance:8,readValueFromPointer:function(s){var u;if(r===1)u=pe;else if(r===2)u=G;else if(r===4)u=Z;else throw new TypeError("Unknown boolean type size: "+n);return this.fromWireType(u[s>>a])},destructorFunction:null})}var we=[],I=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function be(e){e>4&&--I[e].refcount===0&&(I[e]=void 0,we.push(e))}function An(){for(var e=0,n=5;n<I.length;++n)I[n]!==void 0&&++e;return e}function En(){for(var e=5;e<I.length;++e)if(I[e]!==void 0)return I[e];return null}function Tn(){t.count_emval_handles=An,t.get_first_emval=En}var F={toValue:e=>(e||T("Cannot use deleted val. handle = "+e),I[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var n=we.length?we.pop():I.length;return I[n]={refcount:1,value:e},n}}}};function Ae(e){return this.fromWireType(Z[e>>2])}function Fn(e,n){n=R(n),L(e,{name:n,fromWireType:function(r){var i=F.toValue(r);return be(r),i},toWireType:function(r,i){return F.toHandle(i)},argPackAdvance:8,readValueFromPointer:Ae,destructorFunction:null})}function Cn(e,n){switch(n){case 2:return function(r){return this.fromWireType(Pe[r>>2])};case 3:return function(r){return this.fromWireType(ke[r>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Un(e,n,r){var i=me(r);n=R(n),L(e,{name:n,fromWireType:function(o){return o},toWireType:function(o,a){return a},argPackAdvance:8,readValueFromPointer:Cn(n,i),destructorFunction:null})}function Rn(e,n){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=Be(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var i=new r,o=e.apply(i,n);return o instanceof Object?o:i}function Ye(e){for(;e.length;){var n=e.pop(),r=e.pop();r(n)}}function Pn(e,n,r,i,o){var a=n.length;a<2&&T("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=n[1]!==null&&r!==null,u=!1,f=1;f<n.length;++f)if(n[f]!==null&&n[f].destructorFunction===void 0){u=!0;break}for(var c=n[0].name!=="void",A="",p="",f=0;f<a-2;++f)A+=(f!==0?", ":"")+"arg"+f,p+=(f!==0?", ":"")+"arg"+f+"Wired";var m="return function "+xe(e)+"("+A+`) {
if (arguments.length !== `+(a-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(a-2)+` args!');
}
`;u&&(m+=`var destructors = [];
`);var J=u?"destructors":"null",B=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],ie=[T,i,o,Ye,n[0],n[1]];s&&(m+="var thisWired = classParam.toWireType("+J+`, this);
`);for(var f=0;f<a-2;++f)m+="var arg"+f+"Wired = argType"+f+".toWireType("+J+", arg"+f+"); // "+n[f+2].name+`
`,B.push("argType"+f),ie.push(n[f+2]);if(s&&(p="thisWired"+(p.length>0?", ":"")+p),m+=(c?"var rv = ":"")+"invoker(fn"+(p.length>0?", ":"")+p+`);
`,u)m+=`runDestructors(destructors);
`;else for(var f=s?1:2;f<n.length;++f){var ne=f===1?"thisWired":"arg"+(f-2)+"Wired";n[f].destructorFunction!==null&&(m+=ne+"_dtor("+ne+"); // "+n[f].name+`
`,B.push(ne+"_dtor"),ie.push(n[f].destructorFunction))}c&&(m+=`var ret = retType.fromWireType(rv);
return ret;
`),m+=`}
`,B.push(m);var mr=Rn(Function,B).apply(null,ie);return mr}function kn(e,n,r){if(e[n].overloadTable===void 0){var i=e[n];e[n]=function(){return e[n].overloadTable.hasOwnProperty(arguments.length)||T("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[n].overloadTable+")!"),e[n].overloadTable[arguments.length].apply(this,arguments)},e[n].overloadTable=[],e[n].overloadTable[i.argCount]=i}}function Sn(e,n,r){t.hasOwnProperty(e)?((r===void 0||t[e].overloadTable!==void 0&&t[e].overloadTable[r]!==void 0)&&T("Cannot register public name '"+e+"' twice"),kn(t,e,e),t.hasOwnProperty(r)&&T("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),t[e].overloadTable[r]=n):(t[e]=n,r!==void 0&&(t[e].numArguments=r))}function Wn(e,n){for(var r=[],i=0;i<e;i++)r.push(S[n+i*4>>2]);return r}function In(e,n,r){t.hasOwnProperty(e)||qe("Replacing nonexistant public symbol"),t[e].overloadTable!==void 0&&r!==void 0?t[e].overloadTable[r]=n:(t[e]=n,t[e].argCount=r)}function Vn(e,n,r){var i=t["dynCall_"+e];return r&&r.length?i.apply(null,[n].concat(r)):i.call(null,n)}var ce=[];function Xe(e){var n=ce[e];return n||(e>=ce.length&&(ce.length=e+1),ce[e]=n=We.get(e)),n}function On(e,n,r){if(e.includes("j"))return Vn(e,n,r);var i=Xe(n).apply(null,r);return i}function Hn(e,n){var r=[];return function(){return r.length=0,Object.assign(r,arguments),On(e,n,r)}}function Ln(e,n){e=R(e);function r(){return e.includes("j")?Hn(e,n):Xe(n)}var i=r();return typeof i!="function"&&T("unknown function pointer with signature "+e+": "+n),i}var Ze=void 0;function $e(e){var n=Ke(e),r=R(n);return D(n),r}function Dn(e,n){var r=[],i={};function o(a){if(!i[a]&&!K[a]){if(se[a]){se[a].forEach(o);return}r.push(a),i[a]=!0}}throw n.forEach(o),new Ze(e+": "+r.map($e).join([", "]))}function Mn(e,n,r,i,o,a){var s=Wn(n,r);e=R(e),o=Ln(i,o),Sn(e,function(){Dn("Cannot call "+e+" due to unbound types",s)},n-1),wn([],s,function(u){var f=[u[0],null].concat(u.slice(1));return In(e,Pn(e,f,null,o,a),n-1),[]})}function jn(e,n,r){switch(n){case 0:return r?function(o){return pe[o]}:function(o){return U[o]};case 1:return r?function(o){return G[o>>1]}:function(o){return ge[o>>1]};case 2:return r?function(o){return Z[o>>2]}:function(o){return S[o>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function xn(e,n,r,i,o){n=R(n),o===-1&&(o=4294967295);var a=me(r),s=p=>p;if(i===0){var u=32-8*r;s=p=>p<<u>>>u}var f=n.includes("unsigned"),c=(p,m)=>{},A;f?A=function(p,m){return c(m,this.name),m>>>0}:A=function(p,m){return c(m,this.name),m},L(e,{name:n,fromWireType:s,toWireType:A,argPackAdvance:8,readValueFromPointer:jn(n,a,i!==0),destructorFunction:null})}function Bn(e,n,r){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],o=i[n];function a(s){s=s>>2;var u=S,f=u[s],c=u[s+1];return new o(u.buffer,c,f)}r=R(r),L(e,{name:r,fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{ignoreDuplicateRegistrations:!0})}function Nn(e,n){n=R(n);var r=n==="std::string";L(e,{name:n,fromWireType:function(i){var o=S[i>>2],a=i+4,s;if(r)for(var u=a,f=0;f<=o;++f){var c=a+f;if(f==o||U[c]==0){var A=c-u,p=w(u,A);s===void 0?s=p:(s+=String.fromCharCode(0),s+=p),u=c+1}}else{for(var m=new Array(o),f=0;f<o;++f)m[f]=String.fromCharCode(U[a+f]);s=m.join("")}return D(i),s},toWireType:function(i,o){o instanceof ArrayBuffer&&(o=new Uint8Array(o));var a,s=typeof o=="string";s||o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||T("Cannot pass non-string to std::string"),r&&s?a=en(o):a=o.length;var u=Te(4+a+1),f=u+4;if(S[u>>2]=a,r&&s)Ge(o,f,a+1);else if(s)for(var c=0;c<a;++c){var A=o.charCodeAt(c);A>255&&(D(f),T("String has UTF-16 code units that do not fit in 8 bits")),U[f+c]=A}else for(var c=0;c<a;++c)U[f+c]=o[c];return i!==null&&i.push(D,u),u},argPackAdvance:8,readValueFromPointer:Ae,destructorFunction:function(i){D(i)}})}function zn(e,n){for(var r="",i=0;!(i>=n/2);++i){var o=G[e+i*2>>1];if(o==0)break;r+=String.fromCharCode(o)}return r}function qn(e,n,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var i=n,o=r<e.length*2?r/2:e.length,a=0;a<o;++a){var s=e.charCodeAt(a);G[n>>1]=s,n+=2}return G[n>>1]=0,n-i}function Yn(e){return e.length*2}function Xn(e,n){for(var r=0,i="";!(r>=n/4);){var o=Z[e+r*4>>2];if(o==0)break;if(++r,o>=65536){var a=o-65536;i+=String.fromCharCode(55296|a>>10,56320|a&1023)}else i+=String.fromCharCode(o)}return i}function Zn(e,n,r){if(r===void 0&&(r=2147483647),r<4)return 0;for(var i=n,o=i+r-4,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343){var u=e.charCodeAt(++a);s=65536+((s&1023)<<10)|u&1023}if(Z[n>>2]=s,n+=4,n+4>o)break}return Z[n>>2]=0,n-i}function $n(e){for(var n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,n+=4}return n}function Kn(e,n,r){r=R(r);var i,o,a,s,u;n===2?(i=zn,o=qn,s=Yn,a=()=>ge,u=1):n===4&&(i=Xn,o=Zn,s=$n,a=()=>S,u=2),L(e,{name:r,fromWireType:function(f){for(var c=S[f>>2],A=a(),p,m=f+4,J=0;J<=c;++J){var B=f+4+J*n;if(J==c||A[B>>u]==0){var ie=B-m,ne=i(m,ie);p===void 0?p=ne:(p+=String.fromCharCode(0),p+=ne),m=B+n}}return D(f),p},toWireType:function(f,c){typeof c!="string"&&T("Cannot pass non-string to C++ string type "+r);var A=s(c),p=Te(4+A+n);return S[p>>2]=A>>u,o(c,p+4,A+n),f!==null&&f.push(D,p),p},argPackAdvance:8,readValueFromPointer:Ae,destructorFunction:function(f){D(f)}})}function Jn(e,n){n=R(n),L(e,{isVoid:!0,name:n,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,i){}})}function Ee(e,n){var r=K[e];return r===void 0&&T(n+" has unknown type "+$e(e)),r}function Qn(e,n,r){e=F.toValue(e),n=Ee(n,"emval::as");var i=[],o=F.toHandle(i);return S[r>>2]=o,n.toWireType(i,e)}function Gn(e,n){for(var r=new Array(e),i=0;i<e;++i)r[i]=Ee(S[n+i*de>>2],"parameter "+i);return r}function er(e,n,r,i){e=F.toValue(e);for(var o=Gn(n,r),a=new Array(n),s=0;s<n;++s){var u=o[s];a[s]=u.readValueFromPointer(i),i+=u.argPackAdvance}var f=e.apply(void 0,a);return F.toHandle(f)}function nr(e,n){return e=F.toValue(e),n=F.toValue(n),F.toHandle(e[n])}function rr(e){e>4&&(I[e].refcount+=1)}function tr(e){return e=F.toValue(e),typeof e=="number"}var ir={};function or(e){var n=ir[e];return n===void 0?R(e):n}function ar(e){return F.toHandle(or(e))}function ur(e){var n=F.toValue(e);Ye(n),be(e)}function fr(e,n){e=Ee(e,"_emval_take_value");var r=e.readValueFromPointer(n);return F.toHandle(r)}function sr(){te("")}function cr(e,n,r){U.copyWithin(e,n,n+r)}function lr(){return 2147483648}function dr(e){var n=y.buffer;try{return y.grow(e-n.byteLength+65535>>>16),Se(),1}catch{}}function vr(e){var n=U.length;e=e>>>0;var r=lr();if(e>r)return!1;let i=(f,c)=>f+(c-f%c)%c;for(var o=1;o<=4;o*=2){var a=n*(1+.2/o);a=Math.min(a,e+100663296);var s=Math.min(r,i(Math.max(e,a),65536)),u=dr(s);if(u)return!0}return!1}_n(),Ne=t.BindingError=ye(Error,"BindingError"),ze=t.InternalError=ye(Error,"InternalError"),Tn(),Ze=t.UnboundTypeError=ye(Error,"UnboundTypeError");var pr={a:gn,q:hn,u:bn,t:Fn,o:Un,h:Mn,d:xn,c:Bn,n:Nn,l:Kn,v:Jn,k:Qn,w:er,b:be,e:nr,g:rr,p:tr,f:ar,j:ur,i:fr,m:sr,s:cr,r:vr},Sr=pn(),gr=t.___wasm_call_ctors=function(){return(gr=t.___wasm_call_ctors=t.asm.y).apply(null,arguments)},Te=t._malloc=function(){return(Te=t._malloc=t.asm.z).apply(null,arguments)},D=t._free=function(){return(D=t._free=t.asm.A).apply(null,arguments)},Ke=t.___getTypeName=function(){return(Ke=t.___getTypeName=t.asm.C).apply(null,arguments)},hr=t.__embind_initialize_bindings=function(){return(hr=t.__embind_initialize_bindings=t.asm.D).apply(null,arguments)},_r=t.dynCall_ijiii=function(){return(_r=t.dynCall_ijiii=t.asm.E).apply(null,arguments)},le;re=function e(){le||Je(),le||(re=e)};function Je(e){if(e=e||h,$>0||(tn(),$>0))return;function n(){le||(le=!0,t.calledRun=!0,!k&&(on(),g(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),an()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),n()},1)):n()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Je(),t.ready}})();typeof exports=="object"&&typeof module=="object"?module.exports=oe:typeof define=="function"&&define.amd?define([],function(){return oe}):typeof exports=="object"&&(exports.Module=oe);var Ce=new Uint8Array([0,0,0,1]);function Fr(d){console.error(d)}oe.createFile=Ue;function Ue(d=256){let l=0,t=0,g=new Uint8Array(d);return{contents:function(){return g.slice(0,t)},seek:function(v){l=v},write:function(v){let h=v.byteLength;return _(l+h),g.set(v,l),l+=h,t=Math.max(t,l),h}};function _(v){var h=g.length;if(h>=v)return;var O=1024*1024;v=Math.max(v,h*(h<O?2:1.125)>>>0),h!=0&&(v=Math.max(v,256));let H=g;g=new Uint8Array(v),t>0&&g.set(H.subarray(0,t),0)}}oe.isWebCodecsSupported=Re;function Re(){return typeof window<"u"&&typeof window.VideoEncoder=="function"}function Qe(d,l={}){let{width:t,height:g,groupOfPictures:_=20,fps:v=30,fragmentation:h=!1,sequential:O=!1,hevc:H=!1,format:N="annexb",codec:Q="avc1.4d0034",acceleration:z,bitrate:E,error:P=Fr,encoderOptions:M={},flushFrequency:ae=10}=l;if(!Re())throw new Error("MP4 H264 encoding/decoding depends on WebCodecs API which is not supported in this environment");if(typeof t!="number"||typeof g!="number")throw new Error("Must specify { width, height } options");if(!isFinite(t)||t<0||!isFinite(g)||g<0)throw new Error("{ width, height } options must be positive integers");let q=Ue(),ue=d.create_muxer({width:t,height:g,fps:v,fragmentation:h,sequential:O,hevc:H},x),fe={codec:Q,width:t,height:g,avc:{format:N},hardwareAcceleration:z,bitrate:E,...M},j=0,Y=new window.VideoEncoder({output(b,y){X(b,y)},error:P});return Y.configure(fe),{async end(){return await Y.flush(),Y.close(),d.finalize_muxer(ue),q.contents()},async addFrame(b){let y=1/v*j*1e6,k=j%_===0,C=new VideoFrame(b,{timestamp:y});Y.encode(C,{keyFrame:k}),C.close(),ae!=null&&(j+1)%ae===0&&await Y.flush(),j++},async flush(){return Y.flush()}};function x(b,y,k){q.seek(k);let C=d.HEAPU8.subarray(b,b+y);return q.write(C)!==C.byteLength}function de(b){let y=d._malloc(b.byteLength);d.HEAPU8.set(b,y),d.mux_nal(ue,y,b.byteLength),d._free(y)}function X(b,y){let k=null,C;if(y&&(y.description&&(C=y.description),y.decoderConfig&&y.decoderConfig.description&&(C=y.decoderConfig.description)),C)try{k=Rr(C)}catch(w){P(w);return}let V=[];if(k&&(k.sps_list.forEach(w=>{V.push(Ce),V.push(w)}),k.pps_list.forEach(w=>{V.push(Ce),V.push(w)})),N==="annexb"){let w=new Uint8Array(b.byteLength);b.copyTo(w),V.push(w)}else try{let w=new ArrayBuffer(b.byteLength);b.copyTo(w),Ur(w).forEach(ve=>{V.push(Ce),V.push(ve)})}catch(w){P(w);return}de(Cr(V))}}function Cr(d){let l=d.reduce((_,v)=>_+v.byteLength,0),t=new Uint8Array(l),g=0;for(let _=0;_<d.length;_++){let v=d[_];t.set(v,g),g+=v.byteLength}return t}function Ur(d){let t=0,g=[],_=d.byteLength,v=new Uint8Array(d);for(;t+4<_;){let h=v[t];if(h=(h<<8)+v[t+1],h=(h<<8)+v[t+2],h=(h<<8)+v[t+3],g.push(new Uint8Array(d,t+4,h)),h==0)throw new Error("Error: invalid nal_length 0");t+=4+h}return g}function Rr(d){let l=new DataView(d),t=0,g=l.getUint8(t++),_=l.getUint8(t++),v=l.getUint8(t++),h=l.getUint8(t++),O=(l.getUint8(t++)&3)+1;if(O!==4)throw new Error("Expected length_size to indicate 4 bytes");let H=l.getUint8(t++)&31,N=[];for(let E=0;E<H;E++){let P=l.getUint16(t,!1);t+=2;let M=new Uint8Array(l.buffer,t,P);N.push(M),t+=P}let Q=l.getUint8(t++),z=[];for(let E=0;E<Q;E++){let P=l.getUint16(t,!1);t+=2;let M=new Uint8Array(l.buffer,t,P);z.push(M),t+=P}return{offset:t,version:g,profile:_,compat:v,level:h,length_size:O,pps_list:z,sps_list:N,numSPS:H}}0&&(module.exports={createFile,createWebCodecsEncoderWithModule,isWebCodecsSupported});
//# sourceMappingURL=mp4.node.js.map
